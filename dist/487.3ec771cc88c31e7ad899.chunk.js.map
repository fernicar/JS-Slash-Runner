{"version":3,"file":"487.3ec771cc88c31e7ad899.chunk.js","mappings":"oHAAO,SAASA,EAAMC,GACpB,IAEE,OADA,IAAIC,IAAID,IACD,CACT,CAAE,MAAOE,GACP,OAAO,CACT,CACF,C,2ICUO,MAAMC,EAAuD,CAClE,IAAK,CACHC,KAAM,gCACNC,QAAS,iFACTC,KAAM,kFAER,KAAM,CACJF,KAAM,iCACNC,QAAS,kFACTC,KAAM,mFAER,MAAO,CACLF,KAAM,QACNC,QAAS,mFACTC,KAAM,oFAER,KAAM,CACJF,KAAM,mBACNC,QAAS,kFACTC,KAAM,mFAER,aAAc,CACZF,KAAM,eACNC,QAAS,0FACTC,KAAM,2FAER,YAAa,CACXF,KAAM,cACNC,QAAS,yFACTC,KAAM,0FAER,UAAW,CACTF,KAAM,YACNC,QAAS,uFACTC,KAAM,yFAQVC,eAAeC,EAAeF,GAC5B,OAAOP,EAAMO,UAAeG,MAAMH,IAAOI,OAASJ,CACpD,CAOOC,eAAeI,EAAoBC,GACxC,MAAMC,EAASV,EAAuBS,GACtC,IAAKC,EAEH,OADA,UAAU,4BAA4BD,KAC/B,KAGT,IACE,MAAO,CACLE,GAAIF,EACJR,KAAMS,EAAOT,KACbC,SAxBqBA,EAwBMQ,EAAOR,QAvB/BN,EAAMM,GAAW,WAAWA,KAAaA,GAwB5CC,WAAYE,EAAeK,EAAOP,MAClCS,SAAS,EACTC,QAAS,GACTC,KAAM,CAAC,EAEX,CAAE,MAAOf,GAEP,OADA,UAAU,6BAA6BU,KAAcV,GAC9C,IACT,CAjCF,IAA2BG,CAkC3B,CAOOE,eAAeW,EAAaC,GACjC,aAAcR,EAAoBQ,IAAU,CAAC,CAC/C,CAMOZ,eAAea,IACpBC,OAAOf,KAAK,eACZ,MAAMgB,QAAeC,QAAQC,IAC3BC,OAAOC,KAAKvB,GAAwBwB,IAAIf,GAAaD,EAAoBC,KAO3E,OALIU,EAAOM,KAAKC,GAAiB,OAATA,GACtBR,OAAOnB,MAAM,YAEbmB,OAAOS,QAAQ,YAEVR,CACT,C","sources":["webpack://JS-Slash-Runner/./src/util/is_url.ts","webpack://JS-Slash-Runner/./src/component/script_repository/builtin_scripts.ts"],"sourcesContent":["export function isUrl(url: string): boolean {\n  try {\n    new URL(url);\n    return true;\n  } catch (error) {\n    return false;\n  }\n}\n","import { isUrl } from '@/util/is_url';\n\nimport log from 'loglevel';\n\n/**\n * 默认脚本配置类型\n */\ntype ScriptConfig = {\n  name: string;\n  content: string;\n  info: string;\n};\n\n/**\n * 默认脚本配置\n * 包含每个默认脚本的基本信息\n */\nexport const DEFAULT_SCRIPT_CONFIGS: Record<string, ScriptConfig> = {\n  标签化: {\n    name: '标签化: 随世界书、预设或链接配置自动开关正则、提示词条目',\n    content: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/标签化/index.js',\n    info: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/标签化/README.md',\n  },\n  样式加载: {\n    name: '样式加载: 像酒馆主题自定义 css 一样编写角色卡 css',\n    content: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/样式加载/index.js',\n    info: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/样式加载/README.md',\n  },\n  预设防误触: {\n    name: '预设防误触',\n    content: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/预设防误触/index.js',\n    info: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/预设防误触/README.md',\n  },\n  资源预载: {\n    name: '资源预载: 提前缓存角色卡的插图',\n    content: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/资源预载/index.js',\n    info: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/资源预载/README.md',\n  },\n  自动关闭前端卡不兼容选项: {\n    name: '自动关闭前端卡不兼容选项',\n    content: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/自动关闭前端卡不兼容选项/index.js',\n    info: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/自动关闭前端卡不兼容选项/README.md',\n  },\n  自动开启角色卡局部正则: {\n    name: '自动开启角色卡局部正则',\n    content: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/自动开启角色卡局部正则/index.js',\n    info: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/自动开启角色卡局部正则/README.md',\n  },\n  查看提示词发送情况: {\n    name: '查看提示词发送情况',\n    content: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/dist/酒馆助手/查看提示词发送情况/index.js',\n    info: 'https://fastly.jsdelivr.net/gh/StageDog/tavern_resource/src/酒馆助手/查看提示词发送情况/README.md',\n  },\n};\n\nfunction loadScriptContent(content: string): string {\n  return isUrl(content) ? `import '${content}'` : content;\n}\n\nasync function loadScriptInfo(info: string): Promise<string> {\n  return isUrl(info) ? (await fetch(info)).text() : info;\n}\n\n/**\n * 创建单个默认脚本\n * @param script_id 脚本ID\n * @returns 脚本对象\n */\nexport async function createDefaultScript(script_id: string): Promise<any> {\n  const config = DEFAULT_SCRIPT_CONFIGS[script_id];\n  if (!config) {\n    log.error(`[ScriptManager] 未找到脚本配置: ${script_id}`);\n    return null;\n  }\n\n  try {\n    return {\n      id: script_id,\n      name: config.name,\n      content: loadScriptContent(config.content),\n      info: await loadScriptInfo(config.info),\n      enabled: false,\n      buttons: [],\n      data: {},\n    };\n  } catch (error) {\n    log.error(`[ScriptManager] 创建默认脚本失败: ${script_id}:`, error);\n    return null;\n  }\n}\n\n/**\n * 创建指定类型的默认脚本\n * @param type 脚本类型\n * @returns 脚本对象\n */\nexport async function createScript(type: keyof typeof DEFAULT_SCRIPT_CONFIGS): Promise<any> {\n  return (await createDefaultScript(type)) || {};\n}\n\n/**\n * 创建所有默认脚本\n * @returns 默认脚本数组\n */\nexport async function createDefaultScripts(): Promise<any[]> {\n  toastr.info('正在加载默认脚本...');\n  const result = await Promise.all(\n    Object.keys(DEFAULT_SCRIPT_CONFIGS).map(script_id => createDefaultScript(script_id)),\n  );\n  if (result.some(item => item === null)) {\n    toastr.error('创建默认脚本失败');\n  } else {\n    toastr.success('创建默认脚本成功');\n  }\n  return result;\n}\n"],"names":["isUrl","url","URL","error","DEFAULT_SCRIPT_CONFIGS","name","content","info","async","loadScriptInfo","fetch","text","createDefaultScript","script_id","config","id","enabled","buttons","data","createScript","type","createDefaultScripts","toastr","result","Promise","all","Object","keys","map","some","item","success"],"sourceRoot":""}